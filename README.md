# kfd_lab_4


# API эндпоинты

#1. Аутентификация и регистрация
Регистрация пользователя (Sign Up)
Метод: POST
URL: /api/auth/signup
Тело запроса (JSON):
json

Copy
{
  "username": "bob",
  "password": "password_bob",
  "authorities": ["ROLE_USER"]
}
Назначение: Создаёт нового пользователя с указанными ролями и начальным балансом (например, RUB).
Аутентификация (Sign In)
Метод: POST
URL: /api/auth/signin
Тело запроса (JSON):
json

Copy
{
  "username": "bob",
  "password": "password_bob"
}
Назначение: Проверяет учётные данные и возвращает JWT‑токен для последующих запросов.
4.2. Работа с данными пользователя
Получение данных пользователя
Метод: GET
URL: /api/users/{username}
Заголовок: Authorization: Bearer <jwt_token>
Назначение: Возвращает информацию о пользователе (имя, список ролей, балансы и пр.).
Получение балансов пользователя
Метод: GET
URL: /api/balance/{username}
Заголовок: Authorization: Bearer <jwt_token>
Назначение: Возвращает список балансов пользователя по разным валютам.
Обновление (пополнение) балансов пользователя (только для ADMIN)
Метод: POST
URL: /api/balance/{username}
Заголовок: Authorization: Bearer <admin_jwt_token>
Тело запроса (JSON):
json

Copy
[
  {
    "currencyCode": "USD",
    "amount": 50000
  },
  {
    "currencyCode": "EUR",
    "amount": 30000
  }
]
Назначение: Администратор может пополнить или создать балансы для пользователя. Если валюта отсутствует – создаётся новый баланс, иначе сумма добавляется к существующему значению.
4.3. Балансы терминала (Exchanger Balance)
Для работы с балансами терминала (отдельной сущностью) создан отдельный контроллер.

Получение балансов терминала
Метод: GET
URL: /api/exchangerbalance
Заголовок: Authorization: Bearer <jwt_token>
Назначение: Возвращает список всех балансов терминала. Запрос может выполняться любым аутентифицированным пользователем (например, bob).
Обновление балансов терминала (только для ADMIN)
Метод: POST
URL: /api/exchangerbalance
Заголовки:
Content-Type: application/json
Authorization: Bearer <admin_jwt_token>
Тело запроса (JSON):
json

Copy
[
  {
    "currencyCode": "GBP",
    "amount": 20000
  },
  {
    "currencyCode": "JPY",
    "amount": 100000
  }
]
Назначение: Позволяет администратору пополнить балансы терминала. Если баланс по указанной валюте уже существует, то сумма увеличивается, иначе создаётся новая запись.
4.4. Работа с валютными курсами (Rates)
Просмотр валютных пар и курсов
Метод: GET
URL: /api/rates
Заголовок: Authorization: Bearer <jwt_token>
Назначение: Позволяет получить список валютных пар с текущими курсами обмена.
Добавление новой валютной пары (только для ADMIN)
Метод: POST
URL: /api/rates
Заголовок: Authorization: Bearer <admin_jwt_token>
Тело запроса (JSON):
json

Copy
{
  "baseCurrency": "RUB",
  "quoteCurrency": "USD",
  "rate": 9000,
  "factor": 100
}
Назначение: Создаёт новую валютную пару (например, RUB/USD) и задаёт обменный курс с коэффициентом.
Обновление валютных курсов (только для ADMIN)
Метод: POST
URL: /api/rates/update
Заголовок: Authorization: Bearer <admin_jwt_token>
Тело запроса: отсутствует или пустое
Назначение: Пересчитывает и возвращает обновлённые курсы для всех валютных пар.
4.5. Операции обмена валют (Transactions)
Проведение обмена валют
Метод: POST
URL: /api/transactions/exchange
Заголовок: Authorization: Bearer <jwt_token>
Тело запроса (JSON):
json

Copy
{
  "username": "bob",
  "fromCurrency": "RUB",
  "toCurrency": "USD",
  "amount": 1000
}
Назначение: Пользователь (например, bob) может провести операцию обмена, в результате которой происходит списание суммы в базовой валюте и зачисление суммы в валюте назначения по определённому курсу. При этом в контроллере может использоваться проверка, чтобы имя пользователя в токене совпадало с полем "username".
Получение истории транзакций пользователя
Метод: GET
URL: /api/transactions/user/{username}
Заголовок: Authorization: Bearer <jwt_token>
Назначение: Возвращает список всех проведённых транзакций для указанного пользователя.
